sso.dq2020 %>%
pivot_longer(cols = c(Value, SE), names_to = "Type") %>%
select(Variable, Yr, Type, Ass2020 = "value"),
bind_rows(ssos.dq2000,sso.dqa,sso.dqc) %>%
pivot_longer(cols = c(Value, SE), names_to = "Type"),
by = c("Variable", "Yr", "Type")
)
full_join(
sso.dq2020 %>%
pivot_longer(cols = c(Value, SE), names_to = "Type") %>%
select(Variable, Yr, Type, Ass2020 = "value"),
bind_rows(sso.dq2000,sso.dqa,sso.dqc) %>%
pivot_longer(cols = c(Value, SE), names_to = "Type"),
by = c("Variable", "Yr", "Type")
)
full_join(
sso.dq2020 %>%
pivot_longer(cols = c(Value, SE), names_to = "Type") %>%
select(Variable, Yr, Type, Ass2020 = "value"),
bind_rows(sso.dq2020,sso.dqa,sso.dqc) %>%
pivot_longer(cols = c(Value, SE), names_to = "Type"),
by = c("Variable", "Yr", "Type")
)
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
runa <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/Final_setupa',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- list(runa,teste)
cpl.sum <- SSsummarize(biglist=cpl)
xx <- SStableComparisons(cpl.sum)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
sso.runa <- SS_read_summary(file = "D:/IPMA/SARDINE/Interbenchmark2021/testes/Final_setupa/ss_summary.sso",verbose = TRUE)
sso.dqa <- sso.runa$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.teste <- SS_read_summary(file = "D:/IPMA/SARDINE/Interbenchmark2021/testes/teste/ss_summary.sso",verbose = TRUE)
sso.dqteste <- sso.teste$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dqa-sso.dqteste
sso.dqa
sso.dqa-sso.dqteste
sso.dqteste
sso.dqa$Value-sso.dqteste$Value
sso.dqa$SE-sso.dqteste$SE
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- list(runa,teste)
cpl.sum <- SSsummarize(biglist=cpl)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
sso.teste <- SS_read_summary(file = "D:/IPMA/SARDINE/Interbenchmark2021/testes/teste/ss_summary.sso",verbose = TRUE)
sso.dqteste <- sso.teste$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dqa$Value-sso.dqteste$Value
sso.dqa$SE-sso.dqteste$SE
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- list(runa,teste)
cpl.sum <- SSsummarize(biglist=cpl)
xx <- SStableComparisons(cpl.sum)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
sso.teste <- SS_read_summary(file = "D:/IPMA/SARDINE/Interbenchmark2021/testes/teste/ss_summary.sso",verbose = TRUE)
sso.dqteste <- sso.teste$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dqa$Value-sso.dqteste$Value
runa <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/Final_setupa',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
run4 <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/#4',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- c(runa,run4)
cpl.sum <- SSsummarize(biglist=cpl)
xx <- SStableComparisons(cpl.sum)
cpl <- list(runa,run4)
xx <- SStableComparisons(cpl.sum)
cpl.sum <- SSsummarize(biglist=cpl)
xx <- SStableComparisons(cpl.sum)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- list(runa,teste)
cpl.sum <- SSsummarize(biglist=cpl)
xx <- SStableComparisons(cpl.sum)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
sso.teste <- SS_read_summary(file = "D:/IPMA/SARDINE/Interbenchmark2021/testes/teste/ss_summary.sso",verbose = TRUE)
sso.dqteste <- sso.teste$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dqa$Value-sso.dqteste$Value
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- list(runa,teste)
cpl.sum <- SSsummarize(biglist=cpl)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
sso.teste <- SS_read_summary(file = "D:/IPMA/SARDINE/Interbenchmark2021/testes/teste/ss_summary.sso",verbose = TRUE)
sso.dqteste <- sso.teste$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dqa$Value-sso.dqteste$Value
sso.dqa$SE-sso.dqteste$SE
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- list(runa,teste)
cpl.sum <- SSsummarize(biglist=cpl)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
sso.teste <- SS_read_summary(file = "D:/IPMA/SARDINE/Interbenchmark2021/testes/teste/ss_summary.sso",verbose = TRUE)
sso.dqteste <- sso.teste$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dqa$Value-sso.dqteste$Value
sso.dqa$SE-sso.dqteste$SE
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- list(runa,teste)
cpl.sum <- SSsummarize(biglist=cpl)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
sso.teste <- SS_read_summary(file = "D:/IPMA/SARDINE/Interbenchmark2021/testes/teste/ss_summary.sso",verbose = TRUE)
sso.dqteste <- sso.teste$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dqa$Value-sso.dqteste$Value
sso.dqa$SE-sso.dqteste$SE
runc <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/Final_setupc',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- list(runc,teste)
cpl.sum <- SSsummarize(biglist=cpl)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
sso.teste <- SS_read_summary(file = "D:/IPMA/SARDINE/Interbenchmark2021/testes/teste/ss_summary.sso",verbose = TRUE)
sso.dqteste <- sso.teste$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dqa$Value-sso.dqteste$Value
sso.dqa$SE-sso.dqteste$SE
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021))
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(13),indexfleets = c(2),xlim=c(1978,2021))
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(13),indexfleets = c(3),xlim=c(1978,2021))
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(13),indexfleets = c(4),xlim=c(1978,2021))
runc$maximum_gradient_component
teste$maximum_gradient_component
runa <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/Final_setupa',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
runc <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/Final_setupc',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
# compare models
cpl <- list(run2020,runa,runa.DEPM,runc,runc.DEPM)
cpl.sum <- SSsummarize(biglist=cpl)
xx <- SStableComparisons(cpl.sum)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
sso.runa <- SS_read_summary(file = "D:/IPMA/SARDINE/Interbenchmark2021/testes/Final_setupa/ss_summary.sso",verbose = TRUE)
sso.dqa <- sso.runa$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dqa$Run <- "Setupa"
sso.runc <- SS_read_summary(file = "D:/IPMA/SARDINE/Interbenchmark2021/testes/Final_setupc/ss_summary.sso",verbose = TRUE)
sso.dqc <- sso.runc$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dqc$Run <- "Setupc"
sso.2020 <- SS_read_summary(file = "D:/IPMA/SARDINE/WGHANSA2020/SS3/2020_Update/ss_summary.sso",verbose = TRUE)
sso.dq2020 <- sso.2020$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dq2020$Run <- "Ass2020"
ssos <-
full_join(
sso.dq2020 %>%
pivot_longer(cols = c(Value, SE), names_to = "Type") %>%
select(Variable, Yr, Type, Ass2020 = "value"),
bind_rows(sso.dq2020,sso.dqa,sso.dqc) %>%
pivot_longer(cols = c(Value, SE), names_to = "Type"),
by = c("Variable", "Yr", "Type")
) %>%
mutate(delta = Ass2020 - value)
sso.dqa$Value-sso.dqc$Value
sso.dqa$SE-sso.dqc$SE
ssos <-
full_join(
sso.dq2020 %>%
pivot_longer(cols = c(Value, SE), names_to = "Type") %>%
select(Variable, Yr, Type, Ass2020 = "value"),
bind_rows(sso.dq2020,sso.dqa,sso.dqc) %>%
pivot_longer(cols = c(Value, SE), names_to = "Type"),
by = c("Variable", "Yr", "Type")
) %>%
mutate(delta = Ass2020 - value)
ssos
ssos %>% group_by(Variable, Type, Run)%>% summarise (mean= mean(value), sd=sd(value))
ssos %>% group_by(Variable, Type, Run)%>% summarise (mean= mean(value), sd=sd(value))%>%filter(Variable %in% c("SSB","Recr","F"))
SS_plots(runa)
SS_plots(runc)
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- list(runc,teste)
cpl.sum <- SSsummarize(biglist=cpl)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
sso.teste <- SS_read_summary(file = "D:/IPMA/SARDINE/Interbenchmark2021/testes/teste/ss_summary.sso",verbose = TRUE)
sso.dqteste <- sso.teste$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dqa$Value-sso.dqteste$Value
sso.dqa$SE-sso.dqteste$SE
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- list(runc,teste)
cpl.sum <- SSsummarize(biglist=cpl)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
AIC
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- list(runc,teste)
cpl.sum <- SSsummarize(biglist=cpl)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
xx
xx <- SStableComparisons(cpl.sum)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- list(runc,teste)
cpl.sum <- SSsummarize(biglist=cpl)
xx <- SStableComparisons(cpl.sum)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
sso.teste <- SS_read_summary(file = "D:/IPMA/SARDINE/Interbenchmark2021/testes/teste/ss_summary.sso",verbose = TRUE)
sso.dqteste <- sso.teste$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dqa$Value-sso.dqteste$Value
sso.dqa$SE-sso.dqteste$SE
SS_plots(teste)
SS_plots(teste)
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- list(runc,teste)
cpl.sum <- SSsummarize(biglist=cpl)
xx <- SStableComparisons(cpl.sum)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
sso.teste <- SS_read_summary(file = "D:/IPMA/SARDINE/Interbenchmark2021/testes/teste/ss_summary.sso",verbose = TRUE)
sso.dqteste <- sso.teste$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dqa$Value-sso.dqteste$Value
sso.dqa$SE-sso.dqteste$SE
SS_plots(teste)
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- list(runc,teste)
cpl.sum <- SSsummarize(biglist=cpl)
xx <- SStableComparisons(cpl.sum)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
SS_plots(teste)
runc$maximum_gradient_component
teste$maximum_gradient_component
SSplotComparisons(cpl.sum)
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021))
dev.off()
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021))
cpl <- list(run2020,runc,teste)
cpl.sum <- SSsummarize(biglist=cpl)
dev.off()
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021))
# compare models
cpl <- list(run2020,runa,runa.DEPM,runc,runc.DEPM)
cpl.sum <- SSsummarize(biglist=cpl)
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021))
xx <- SStableComparisons(cpl.sum)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
teste <- SS_output(dir = 'D:/IPMA/SARDINE/Interbenchmark2021/testes/teste',forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
cpl <- list(runa,runc,teste)
cpl.sum <- SSsummarize(biglist=cpl)
xx <- SStableComparisons(cpl.sum)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
SS_plots(teste)
dev.off()
dev.off()
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021))
# compare models
cpl <- list(run2020,runa,runa.DEPM,runc,runc.DEPM)
cpl.sum <- SSsummarize(biglist=cpl)
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021))
cpl <- list(runa,runc)
cpl.sum <- SSsummarize(biglist=cpl)
xx <- SStableComparisons(cpl.sum)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
dev.off()
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021))
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(13),indexfleets = c(2),xlim=c(1978,2021))
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(13),indexfleets = c(3),xlim=c(1978,2021))
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(13),indexfleets = c(4),xlim=c(1978,2021))
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(13),indexfleets = c(2),xlim=c(1978,2021))
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(13),indexfleets = c(3),xlim=c(1978,2021))
cpl <- list(runc,teste)
cpl.sum <- SSsummarize(biglist=cpl)
xx <- SStableComparisons(cpl.sum)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
cpl <- list(runa,teste)
cpl.sum <- SSsummarize(biglist=cpl)
xx <- SStableComparisons(cpl.sum)
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
rbind(xx,AIC)
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021))
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(13),indexfleets = c(2),xlim=c(1978,2021))
rm(list=ls())
#==============================================================================
# WORKING DIRECTORY                                                        ----
#==============================================================================
wd <- "D:/ICES/IBPIS2021"
setwd(wd)
# directory to save plots
res.plots <- file.path("./plots")
# directory with SS runs
res.ss <- file.path("./SS_runs")
# directory with data
res.dir  <- file.path("./data")
library(r4ss)
library(tidyverse)
run2020 <- SS_output(dir = paste0(res.ss,"/2020_Update"),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
# The 2020 assessment model with the 2020 DEPM point estimate (was not available at the time)
run2020.DEPM <- SS_output(dir = paste0(res.ss,"/2020_DEPM"),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
# Setup a - Same settings as the current model but with new recruitment index
runa <- SS_output(dir = paste0(res.ss,'/Setupa'),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
# Setup a - Same settings as the current model but with different recruitment index estimates (years and areas)
run1 <-  SS_output(dir = paste0(res.ss,'/run1'),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE) # w/o ECO-REC all years
run2 <-  SS_output(dir = paste0(res.ss,'/run2'),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE) # 9aCN and 9aCS all years
run3 <-  SS_output(dir = paste0(res.ss,'/run3'),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE) # 9aCN all years
run4 <-  SS_output(dir = paste0(res.ss,'/run4'),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE) # w/o ECO-REC from 1997
run5 <-  SS_output(dir = paste0(res.ss,'/run5'),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE) # 9aCN and 9aCS from 1997
run6 <-  SS_output(dir = paste0(res.ss,'/run6'),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE) # 9aCN from 1997
run7 <-  SS_output(dir = paste0(res.ss,'/run7'),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE) # w/o ECO-REC from 2013
run8 <-  SS_output(dir = paste0(res.ss,'/run8'),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE) # 9aCN and 9aCS from 2013
run9 <-  SS_output(dir = paste0(res.ss,'/run9'),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE) # 9aCN from 2013
run10 <- SS_output(dir = paste0(res.ss,'/run10'),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE) # all areas and years
run11 <- SS_output(dir = paste0(res.ss,'/run11'),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE) # all areas from 1997
run12 <- SS_output(dir = paste0(res.ss,'/run12'),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE) # all areas from 2013
# Setup b - Different selectivity, no time blocks, S-at-age is not dome shaped
runb <- SS_output(dir = paste0(res.ss,'/Setupb'),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
# Setup c - Different selectivity, no time blocks, S-at-age is dome shaped
runc <- SS_output(dir = paste0(res.ss,'/Setupc'),forecast=FALSE,ncols=62,verbose = TRUE, printstats = TRUE)
# Make SS plots for each run
#SS_plots(runa)
#SS_plots(runb)
#SS_plots(runc)
#SS_plots(run2020.DEPM)
cpl <- list(run10,run1,run2,run3,run11,run4,run5,run6,run12,run7,run8,run9)
cpl.sum <- SSsummarize(biglist=cpl)
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021),print = TRUE,plotdir = res.dir)
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(13),indexfleets = c(2),xlim=c(1978,2021),print = TRUE,plotdir = res.dir)
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(13),indexfleets = c(3),xlim=c(1978,2021),print = TRUE,plotdir = res.dir)
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(13),indexfleets = c(4),xlim=c(1978,2021),print = TRUE,plotdir = res.dir)
xx <- SStableComparisons(cpl.sum,models = "all",likenames = c("TOTAL","Survey", "Age_comp"),
names = c("SSB_2020","Recr_2020","F_2019"), digits = rep(2,16),
verbose = TRUE,mcmc = FALSE)
xx <- rbind(xx,c("Maximum Gradient",cpl.sum$maxgrad))
xx <- rbind(xx,cpl.sum$likelihoods[c(2,3,6,9,10),c(ncol(cpl.sum$likelihoods),1:(ncol(cpl.sum$likelihoods)-1))])
xx <- rbind(xx,c("Number parameters",cpl.sum$npars))
AIC <- c(Label="AIC", cpl.sum$npars*2+(2*cpl.sum$likelihoods[1,-ncol(cpl.sum$likelihoods)]))
xx <- rbind(xx,AIC)
xx <- xx[c(1,8,9,2,3,10:13,4:6,14,7),]
xx$Label <- c("Total","Catch","Equil_catch","Survey","Age_comp","Recruitment","Parm_softbounds","Parm_devs","N parm","SSB_2020",
"Recr_2020","F_2019","AIC","Max Grad")
SStableComparisons(cpl.sum,models = "all",likenames = c("TOTAL","Survey", "Age_comp"),
names = c("SSB_2020","Recr_2020","F_2019"), digits = rep(2,16),
verbose = TRUE,mcmc = FALSE)
trace(SSplotComparisons,edit=T)
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021),print = TRUE,plotdir = res.dir,
legendlabels = c("1984, all areas","1984, w/o","1984, 9aCN and 9aCS", "1984, 9aCN",
"1997, all areas","1997, w/o","1997, 9aCN and 9aCS", "1997, 9aCN",
"2013, all areas","2013, w/o","2013, 9aCN and 9aCS", "2013, 9aCN"))
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021),print = TRUE,plotdir = res.dir,
legendlabels = c("G1,All","G1, w/o","G1,OC", "G1, CN",
"G2,All","G2, w/o","G2,OC", "G2, CN",
"G3,All","G3, w/o","G3,OC", "G3, CN",))
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021),print = TRUE,plotdir = res.dir,
legendlabels = c("G1,All","G1, w/o","G1,OC", "G1, CN",
"G2,All","G2, w/o","G2,OC", "G2, CN",
"G3,All","G3, w/o","G3,OC", "G3, CN"))
?legend
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021),print = TRUE,plotdir = res.dir,
legendlabels = c("G1,All","G1, w/o","G1,OC", "G1, CN",
"G2,All","G2, w/o","G2,OC", "G2, CN",
"G3,All","G3, w/o","G3,OC", "G3, CN"),legendloc = "bottom")
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021),print = TRUE,plotdir = res.dir,
legendlabels = c("G1,All","G1, w/o","G1,OC", "G1, CN",
"G2,All","G2, w/o","G2,OC", "G2, CN",
"G3,All","G3, w/o","G3,OC", "G3, CN"),legendloc = "bottomright")
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021),print = TRUE,plotdir = res.dir,
legendlabels = c("G1,All","G1, w/o","G1,OC", "G1, CN",
"G2,All","G2, w/o","G2,OC", "G2, CN",
"G3,All","G3, w/o","G3,OC", "G3, CN"),legendloc = "topright")
?legend
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021),print = TRUE,plotdir = res.dir,
legendlabels = c("G1,All","G1, w/o","G1,OC", "G1, CN",
"G2,All","G2, w/o","G2,OC", "G2, CN",
"G3,All","G3, w/o","G3,OC", "G3, CN"),horiz = T)
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021),print = TRUE,plotdir = res.dir,
legendlabels = c("G1,All","G1, w/o","G1,OC", "G1, CN",
"G2,All","G2, w/o","G2,OC", "G2, CN",
"G3,All","G3, w/o","G3,OC", "G3, CN"),legendloc = "topright")
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021),print = TRUE,plotdir = res.dir,
legendlabels = c("G1,All","G1, w/o","G1,OC", "G1, CN",
"G2,All","G2, w/o","G2,OC", "G2, CN",
"G3,All","G3, w/o","G3,OC", "G3, CN"),legendloc = "topright")
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(2,8,10,12),xlim=c(1978,2021),print = TRUE,plotdir = res.dir,
legendlabels = c("G1, All","G1, w/o","G1, OC", "G1, CN",
"G2, All","G2, w/o","G2, OC", "G2, CN",
"G3, All","G3, w/o","G3, OC", "G3, CN"),legendloc = "topright")
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(12),xlim=c(1978,2021),print = TRUE,plotdir = res.dir,
legendlabels = c("G1, All","G1, w/o","G1, OC", "G1, CN",
"G2, All","G2, w/o","G2, OC", "G2, CN",
"G3, All","G3, w/o","G3, OC", "G3, CN"),legend = FALSE)
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(10),xlim=c(1978,2021),print = TRUE,plotdir = res.dir,
legendlabels = c("G1, All","G1, w/o","G1, OC", "G1, CN",
"G2, All","G2, w/o","G2, OC", "G2, CN",
"G3, All","G3, w/o","G3, OC", "G3, CN"),legend = FALSE)
xx
diff <- function(file.path, name){
sso.run <- SS_read_summary(file = paste0(file.path,"ss_summary.sso"),verbose = TRUE)
sso.dq <- sso.run$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dq$Run <- name
}
diff <- function(file.path, name){
sso.run <- SS_read_summary(file = paste0(file.path,"ss_summary.sso"),verbose = TRUE)
sso.dq <- sso.run$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dq$Run <- name
return(sso.dq)
}
sso.run10 <- diff(file.path=paste0(res.ss,'/run1'),"model1")
diff <- function(file.path, name){
sso.run <- SS_read_summary(file = paste0(file.path,"/ss_summary.sso"),verbose = TRUE)
sso.dq <- sso.run$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dq$Run <- name
return(sso.dq)
}
sso.run10 <- diff(file.path=paste0(res.ss,'/run1'),"model1")
sso.run1 <- diff(file.path=paste0(res.ss,'/run1'),"model1")
sso.run1 <- diff(file.path=paste0(res.ss,'/run10'),"model1")
sso.run2 <- diff(file.path=paste0(res.ss,'/run1'),"model2")
sso.run3 <- diff(file.path=paste0(res.ss,'/run2'),"model3")
sso.run4 <- diff(file.path=paste0(res.ss,'/run3'),"model4")
sso.run5 <- diff(file.path=paste0(res.ss,'/run11'),"model5")
sso.run6 <- diff(file.path=paste0(res.ss,'/run4'),"model6")
sso.run7 <- diff(file.path=paste0(res.ss,'/run5'),"model7")
sso.run8 <- diff(file.path=paste0(res.ss,'/run6'),"model8")
sso.run9 <- diff(file.path=paste0(res.ss,'/run12'),"model9")
sso.run10 <- diff(file.path=paste0(res.ss,'/run7'),"model10")
sso.run11 <- diff(file.path=paste0(res.ss,'/run8'),"model11")
sso.run19 <- diff(file.path=paste0(res.ss,'/run9'),"model12")
sso.run12 <- diff(file.path=paste0(res.ss,'/run9'),"model12")
sso.dq2020
sso.2020 <- SS_read_summary(file = "D:/ICES/IBPIS2021/SS_runs/2020_Update/ss_summary.sso",verbose = TRUE)
sso.dq2020 <- sso.2020$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dq2020$Run <- "Assm2020"
df <-
full_join(
sso.dq2020 %>%
pivot_longer(cols = c(Value, SE), names_to = "Type") %>%
select(Variable, Yr, Type, Ass2020 = "value"),
bind_rows(sso.dq2020,sso.run1,sso.run2,sso.run3,sso.run4,sso.run5,sso.run6,sso.run7,sso.run8,sso.run9,sso.run10,sso.run11,sso.run12) %>%
pivot_longer(cols = c(Value, SE), names_to = "Type"),
by = c("Variable", "Yr", "Type")
) %>%
mutate(delta = Ass2020 - value)
rm(list = ls(pattern = "^sso\\."))
df
df %>%
filter(Yr %in% 1978:2020,Type == "Value", Variable %in% c('SSB','Recr','F')) %>%
mutate(Yr = as.numeric(as.character(Yr))) %>%
ggplot(aes(x=Yr,y=delta,color=Run))+
geom_line()+
facet_wrap(Variable ~ .,scale="free_y",nrow=3)
sso.run1 <- diff(file.path=paste0(res.ss,'/run10'),"G1, All")
sso.run2 <- diff(file.path=paste0(res.ss,'/run1'),"G1, w/o")
sso.run3 <- diff(file.path=paste0(res.ss,'/run2'),"G1, OC")
sso.run4 <- diff(file.path=paste0(res.ss,'/run3'),"G1, CN")
sso.run5 <- diff(file.path=paste0(res.ss,'/run11'),"G2, All")
sso.run6 <- diff(file.path=paste0(res.ss,'/run4'),"G2, w/o")
sso.run7 <- diff(file.path=paste0(res.ss,'/run5'),"G2, OC")
sso.run8 <- diff(file.path=paste0(res.ss,'/run6'),"G2, CN")
sso.run9 <- diff(file.path=paste0(res.ss,'/run12'),"G3, All")
sso.run10 <- diff(file.path=paste0(res.ss,'/run7'),"G3, w/o")
sso.run11 <- diff(file.path=paste0(res.ss,'/run8'),"G3, OC")
sso.run12 <- diff(file.path=paste0(res.ss,'/run9'),"G4, CN")
df <-
full_join(
sso.dq2020 %>%
pivot_longer(cols = c(Value, SE), names_to = "Type") %>%
select(Variable, Yr, Type, Ass2020 = "value"),
bind_rows(sso.dq2020,sso.run1,sso.run2,sso.run3,sso.run4,sso.run5,sso.run6,sso.run7,sso.run8,sso.run9,sso.run10,sso.run11,sso.run12) %>%
pivot_longer(cols = c(Value, SE), names_to = "Type"),
by = c("Variable", "Yr", "Type")
) %>%
mutate(delta = Ass2020 - value)
sso.2020 <- SS_read_summary(file = "D:/ICES/IBPIS2021/SS_runs/2020_Update/ss_summary.sso",verbose = TRUE)
sso.dq2020 <- sso.2020$derived_quants[1:219,] %>% rownames_to_column("rn") %>% separate(rn, into = c("Variable", "Yr"))
sso.dq2020$Run <- "Assm2020"
df <-
full_join(
sso.dq2020 %>%
pivot_longer(cols = c(Value, SE), names_to = "Type") %>%
select(Variable, Yr, Type, Ass2020 = "value"),
bind_rows(sso.dq2020,sso.run1,sso.run2,sso.run3,sso.run4,sso.run5,sso.run6,sso.run7,sso.run8,sso.run9,sso.run10,sso.run11,sso.run12) %>%
pivot_longer(cols = c(Value, SE), names_to = "Type"),
by = c("Variable", "Yr", "Type")
) %>%
mutate(delta = Ass2020 - value)
df %>%
filter(Yr %in% 1978:2020,Type == "Value", Variable %in% c('SSB','Recr','F')) %>%
mutate(Yr = as.numeric(as.character(Yr))) %>%
ggplot(aes(x=Yr,y=delta,color=Run))+
geom_line()+
facet_wrap(Variable ~ .,scale="free_y",nrow=3)
ggsave(paste0(res.plots,'/',"DiffBetweenAreasyears.png"))
df %>%
filter(Yr %in% 1978:2020,Type == "Value", Variable %in% c('SSB','Recr','F')) %>%
mutate(Yr = as.numeric(as.character(Yr))) %>%
ggplot(aes(x=Yr,y=delta,color=Run))+
geom_line()+
facet_wrap(Variable ~ .,scale="free_y",nrow=3)
ggsave(paste0(res.plots,'/',"DiffBetweenAreasyears.png"))
df %>%
filter(Yr %in% 1978:2020,Type == "SE", Variable %in% c('SSB','Recr','F')) %>%
mutate(Yr = as.numeric(as.character(Yr))) %>%
ggplot(aes(x=Yr,y=delta,color=Run))+
geom_line()+
facet_wrap(Variable ~ .,scale="free_y",nrow=3)
ggsave(paste0(res.plots,'/',"SE_DiffBetweenAreasyears.png"))
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(13),indexfleets = c(2),xlim=c(1978,2021),print = TRUE,plotdir = res.dir,
legendlabels = c("G1, All","G1, w/o","G1, OC", "G1, CN",
"G2, All","G2, w/o","G2, OC", "G2, CN",
"G3, All","G3, w/o","G3, OC", "G3, CN"),legendloc = "topright")
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(13),indexfleets = c(3),xlim=c(1978,2021),print = TRUE,plotdir = res.dir,
legendlabels = c("G1, All","G1, w/o","G1, OC", "G1, CN",
"G2, All","G2, w/o","G2, OC", "G2, CN",
"G3, All","G3, w/o","G3, OC", "G3, CN"),legendloc = "topright")
SSplotComparisons(summaryoutput=cpl.sum,subplots = c(13),indexfleets = c(4),xlim=c(1978,2021),print = TRUE,plotdir = res.dir,
legendlabels = c("G1, All","G1, w/o","G1, OC", "G1, CN",
"G2, All","G2, w/o","G2, OC", "G2, CN",
"G3, All","G3, w/o","G3, OC", "G3, CN"),legendloc = "topright")
